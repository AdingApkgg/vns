{{ define "main" }}
<article class="article-main">
  <h1 data-pagefind-body>
    <i class="fas fa-hashtag"></i>&nbsp;{{ .Title }}<sup id="busuanzi_value_page_pv"></sup><a class="post-edit-link"
      href="{{ .Site.Params.contentEdit }}{{ with .File }}{{ .Path }}{{ end }}"
      rel="external nofollow noreferrer" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a>
  </h1>
  {{ if not (eq .Params.postmeta false) }}{{ partial "post-meta.html" . }} {{
  end }} {{ if (and (in .TableOfContents "li") (not (eq .Params.toc false))) }}
  <!-- 右侧滑入的 TOC -->
  <div class="toc-trigger" id="toc-trigger">
    <i class="fas fa-list-ul"></i>
  </div>
  <div class="toc-overlay" id="toc-overlay"></div>
  <div class="toc-sidebar" id="toc-sidebar">
    <div class="toc-header">
      <span><i class="fas fa-list-ul"></i> 文章目录</span>
      <button class="toc-close" id="toc-close"><i class="fas fa-times"></i></button>
    </div>
    <div class="toc-content">
      {{ .TableOfContents }}
    </div>
  </div>
  {{ end }}
  
  {{ if eq .Section "p" }}
  <!-- AI 感想生成区域 - 仅在 /p/ 下显示 -->
  <div class="ai-review-section" id="ai-review">
    <div class="ai-review-header">
      <i class="fas fa-robot"></i>
      <span class="ai-review-title">Asuna 的游玩感想</span>
      <button class="ai-review-regenerate" id="regenerate-review" style="display: none;">
        <i class="fas fa-redo"></i> 重新生成
      </button>
    </div>
    <div class="ai-review-content" id="ai-review-content">
      <div class="ai-review-loading">
        <i class="fas fa-spinner fa-spin"></i>
        <p>Asuna 正在思考中...</p>
      </div>
    </div>
    <div class="ai-review-footer">
      <i class="fas fa-circle-info"></i>
      <span>由 Ollama 的 Qwen3 8B 模型提供 AI 支持</span>
    </div>
  </div>
  {{ end }}
  
  <div class="content" data-pagefind-body>{{ .Content }}</div>
  {{ partial "terms.html" (dict "taxonomy" "categories" "page" .) }} {{ partial
  "terms.html" (dict "taxonomy" "tags" "page" .) }}
</article>
{{ if not (eq .Params.comments false) }} {{ partial "comments.html" . }} {{ end
}} {{ end }}